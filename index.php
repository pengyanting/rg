<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>软件类课程智能云课堂</title>
    <link rel="stylesheet" href="css/common.css">
    <link rel="stylesheet" type="text/css" href="css/index.css" />
    <link rel="stylesheet" type="text/css" href="css/xcConfirm.css"/>
    <link rel="stylesheet" href="css/swiper.min.css">
    <body>
        <div class="zr_top">
            <div class="header  clearfix">
                <div class="logo">
                    <a href="">软件类课程智能云课堂</a>
                </div>
                <div class="user_info">
                    <a href="login.php" class="login_btn hide">登录</a>
                    <a href="javascript:;" class="user_name hide"></a>
                    <a href="javascript:;" class="logout_btn hide">退出</a>
                </div>
            </div>
        </div>
        <div class="nav">
            <div class="w1180">
                <ul>
                    <li class="active"><a href="index.php">首页</a></li>
                    <li><a href="course.php">课程中心</a></li>
                    <li><a href="task.php">我的任务</a></li>
                    <li><a href="message.php">消息中心</a></li>
                    <li><a href="user.php">个人中心</a></li>
                </ul>
            </div>
        </div>
        <!--轮播-->
        <div class="banner">
            <div class="swiper-container">
                <div class="swiper-wrapper">
                    <div class="swiper-slide"><img src="img/banner1.jpg" alt=""></div>
                    <div class="swiper-slide"><img src="img/banner2.jpg" alt=""></div>
                    <div class="swiper-slide"><img src="img/banner1.jpg" alt=""></div>
                </div>
                <div class="swiper-button-prev"></div>
                <div class="swiper-button-next"></div>
                <div class="swiper-pagination"></div>
            </div>
        </div>
        <!--特色课程-->
        <div class="index_course clearfix ">
            <div class="hd">
                <h1 style='text-align: center;font-size: 25px;font-family: "微软雅黑";font-weight: 500;'>热门课程</h3>
            </div>
            <div style="display:flex;">
                <div class="ic_title">
                    <h1>基础课程</h1>
                    <ul>
                        <li><a href="course.php">HTML</a></li>
                        <li><a href="course.php">PHP</a></li>
                        <li><a href="course.php">jascript</a></li>
                        <li><a href="course.php">软建工程</a></li>
                        <li><a href="course.php">高数</a></li>
                        <li><a href="course.php">数据结构</a></li>
                        <li><a href="course.php">c语言</a></li>
                        <li><a href="course.php">c++</a></li>
                        <li><a href="course.php">数据库基础</a></li>
                        <li><a href="course.php">java</a></li>
                    </ul>
                </div>
                <div class="ic_con">
                    <ul class='easy'></ul>
                </div>
            </div>
        </div>
        <!--最新课程-->
        <div class="index_course clearfix w1180">
           <div style='display:flex;'>
                <div class="ic_title  new_course">
                    <h1>进阶课程</h1>
                    <ul>
                        <li><a href="course.php">软件测试</a></li>
                        <li><a href="course.php">可视化编程</a></li>
                        <li><a href="course.php">网站搭建</a></li>
                        <li><a href="course.php">网络系统管理</a></li>
                        <li><a href="course.php">实战案例</a></li>
                        <li><a href="course.php">计算机网络</a></li>
                    </ul>
                </div>
                <div class="ic_con">
                    <ul class='hard'></ul>
                </div>
           </div>
        </div>
        <!--最新任务-->
        <div class="index_bg">
            <div class="task  clearfix">
                <div class="hd">
                    <h1>最新任务</h3>
                </div>
                <div class="task-list clearfix">
                    <!--<div class="task-item">
                        <div class="task-info">
                            <div class="tit">
                                <h3 class="title">拆除发动机</h3>
                                <span class="label b_label">项目测试</span>
                                <span class="label p_label">25道题</span>
                            </div>
                            <p class="info">发动机的维修与保养</p>
                            <p class="time_num">本学期第3次课</p>
                            <span class="time">03-20 14:20</span>
                        </div>
                    </div>-->
                </div>
            </div>
        </div>
        <!--问问资讯-->
        <!--<div class="ww w1180">
        <div class="box clearfix">
            <ul class="event_list">
                <h3 id="2013">2013</h3>
                <li>
                    <span>5月</span>
                    <p><span>文字信息</span></p>
                </li>
                <li>
                    <span>4月</span>
                    <p><span>文字信息，文字信息</span></p>
                </li>
                <li>
                    <span>3月</span>
                    <p><span>文字信息</span></p>
                </li>
            </ul>
        </div>
    </div>-->
        <!--底部-->
        <div class="footer">
            <div class="f-links">
                <h1>友情链接</h1>
                <ul class="clearfix">
                    <li><a target="black" href="http://www.xztc.edu.cn/">忻州师范学院</a></li>
                    <li><a target="black" href="http://jxdw.xztc.edu.cn/computer/jsjx.asp">忻州师范学院计算机系</a></li>
                    <li><a target="black" href="http://www.imooc.com/">慕课网</a></li>
                    <li><a target="black" href="http://www.miaov.com/">妙味学堂</a></li>
                    <li><a target="black" href="http://study.163.com/">网易云课堂</a></li>
                    <li><a target="black" href="http://www.36zhen.cn/">36镇</a></li>
                    <li><a target="black" href="https://www.zhihu.com/">知乎</a></li>
                    <li><a target="black" href="http://class.qq.com/">腾讯精品课</a></li>
                    <li><a target="black" href="http://www.jikexueyuan.com/">极客学院</a></li>
                    <li><a target="black" href="http://www.yzfjy.com/">云中帆教育</a></li>
                </ul>
                <ul class="clearfix">
                    <li><a target="black" href="http://www.sxu.edu.cn/">山西大学</a></li>
                    <li><a target="black" href="http://www.tynu.edu.cn/">太原师范学院</a></li>
                    <li><a target="black" href="http://www.tianxiawangxiao.com/index.aspx?isInside=0">天下网校</a></li>
                    <li><a target="black" href="http://huaban.com">花瓣网</a></li>
                    <li><a target="black" href="http://www.zcool.com.cn">站酷</a></li>
                    <li><a target="black" href="https://www.qidianla.com/">起点学院</a></li>
                    <li><a target="black" href="https://gold.xitu.io/">掘金</a></li>
                    <li><a target="black" href="http://www.tuicool.com/">推酷</a></li>
                    <li><a target="black" href="http://www.weekedu.com/default.htm">为课网校</a></li>
                    <li><a target="black" href="http://www.kgc.cn/">课工厂</a></li>
                </ul>
            </div>
            <p class="cr">Copyright 2017©彭艳婷所有 忻州师范学院计算机系 </p>
        </div>
    </body>
    <script src="js/jquery.js"></script>
    <script src="js/swiper.min.js"></script>
    <script src="js/xcConfirm.js" type="text/javascript" charset="utf-8"></script>
    <script src='js/common.js'></script>
    <script>
        var mySwiper = new Swiper('.swiper-container', {
            autoplay: 5000, //可选选项，自动滑动
            pagination: '.swiper-pagination',
            paginationClickable: true,
            prevButton: '.swiper-button-prev',
            nextButton: '.swiper-button-next',
        })
        $(function () {
            //查询任务
            var datalist;
            $.ajax({
                url: 'php/manage/selecttasklist.php',
                type: 'POST',
                dataType: 'json',
                data: {
                   sql:"select * from tasklist limit 0,4"
                },
                success: function (data) {
                    var str = '';
                    for (var i = 0; i < data.length; i++) {
                        if (data[i].status == '已过期') {
                            data.splice(i, 1)
                        }
                    }
                    datalist = data;
                    for (var index = 0; index < data.length; index++) {
                        str += '<div class="task-item"  status="' + data[index].status +
                            '" username="' +
                            data[index].username + '" id="' +
                            data[index].id + '" userid="' + data[index].userid + '">' +
                            '<div class="task-info">' +
                            '<div class="tit">' +
                            '<h3 class="title">' + data[index].title + '</h3>' +
                            '<span class="label b_label">' + data[index].type + '</span>' +
                            '<span class="label p_label">' + data[index].num + '道题</span>' +
                            '</div>' +
                            '<p class="info">' + data[index].descript + '</p>' +
                            '<p class="time_num">' + data[index].coursetitle + '</p>' +
                            '<span class="time">' + data[index].time + '</span>' +
                            '</div>' +
                            '</div>'
                    }
                    console.log(str)
                    $(".task-list").html(str)
                }
            })
            $(".task-list").on('click', '.task-item', function () {
                if (!localStorage.getItem('username')) {
                  alert('您还未登陆,登陆之后再来做题哦！','warning',function(){
                     window.location='login.php'
                  })
                  return;
                }
                var taskid = $(this).attr('id');
                var username = $(this).attr('username');
                var userid = $(this).attr('userid');
                var status = $(this).attr('status');
                var datalist = $(this).attr('datalist');
                var index = $(this).index();
                if (status == "已过期") {
                    alert('任务已过期，请查看最新任务');
                    return;
                }
                //判断是否第一次点击
                check(taskid, index)
            })
            //判断是否第一次点击任务
            function check(taskid, index) {
                $.ajax({
                    url: 'php/task/seltasklist.php',
                    type: 'POST',
                    dataType: 'json',
                    data: {
                        taskid: taskid,
                        userid: localStorage.getItem('id')
                    },
                    success: function (data) {
                        if (data.length > 0) {
                            window.location = 'test.php?' + 'taskid=' + taskid+'&id='+data[0].id;
                        } else {
                            firstTask(index)
                        }
                    }
                })
            }
            //用户首次点击任务
            function firstTask(index) {
                $.ajax({
                    url: 'php/task/upstudytype.php',
                    type: 'POST',
                    dataType: 'json',
                    data: {
                        title: datalist[index].title,
                        taskid: datalist[index].id,
                        num: datalist[index].num,
                        descript: datalist[index].descript,
                        status: datalist[index].status,
                        type: datalist[index].type,
                        time: datalist[index].time,
                        courseid: datalist[index].courseid,
                        coursetitle: datalist[index].coursetitle,
                        username: localStorage.getItem('username'),
                        userid: localStorage.getItem('id')
                    },
                    success: function (data) {
                        if (data) {
                             check(datalist[index].id, index)
                        }
                    }
                })
            }
            //查询课程
            function sleCourse(type,classname) {
                $.ajax({
                    url: 'php/index/selcoursebytype.php',
                    type: 'POST',
                    dataType: 'json',
                    data: {
                        type: type
                    },
                    success: function (data) {
                        var str = "";
                        for (var i = 0; i < data.length; i++) {
                            if (i > 7) {
                                return;
                            }
                            str += '<li id="'+data[i].id+'">' +
                                '<div class="ic_item">' +
                                '<div class="ic_img">' +
                                '<img src="'+data[i].imgurl+'" alt="">' +
                                '<div class="ic_star">'+data[i].score+'</div>' +
                                '</div>' +
                                '<div class="ic_name">' +
                                '<h4>'+data[i].title+'</h4>' +
                                '<span>'+data[i].teacher+'</span>' +
                                '</div>' +
                                '</div>' +
                                '</li>'
                        }
                        $("."+classname).html(str)
                    }
                })
            }
            sleCourse("基础",'easy')
            sleCourse("高级",'hard')
            $(".ic_con").on('click','li',function(){
                var courseId=$(this).attr('id');
                window.location='coursedetail.php?courseId='+courseId;
            })
        })
    </script>
</html>